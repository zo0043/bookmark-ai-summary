# AI 代码评审在七猫的实践
- URL: https://tech.qimao.com/ai-dai-ma-ping-shen-zai-qi-mao-de-shi-jian/
- Added At: 2025-10-14 14:12:14
- [Link To Text](2025-10-14-ai-代码评审在七猫的实践_raw.md)

## TL;DR
本文介绍了AI代码评审系统，通过Golang和Eino框架实现，支持自动化流程，优化提示词和模型选择，旨在辅助代码评审和为AIOps打下基础。

## Summary
1. **AI 代码评审目标**：
   - 辅助代码评审，提供不同视角发现潜在问题；
   - 掌握 AI 应用工程化核心开发流程与新技术的实践经验，为 AIOps 打下基础。

2. **产品方案**：
   - 采用方案一：用户提交合并请求后自动触发代码评审；
   - 无需额外配置，流程自动化。

3. **技术方案**：
   - **技术选型**：
     - 全代码实现，选择 Golang 语言；
     - 使用字节 Eino 框架进行 AI Agent 开发。
   - **业务流程**：
     - 前置过滤：支持代码组和代码库级别筛选；
     - AB 测试：针对不同模型和提示词进行效果调优；
     - 获取数据：获取增量 diff 数据、commit 数据等；
     - 数据分组：智能分组代码文件；
     - 初审：高风险、中等问题、信息提示；
     - 复审：根据问题打分，输出评论；
     - 行间评论：调用云效 API 反馈结果。

4. **开发过程**：
   - **流程编排**：使用流程编排进行步骤封装，提高可维护性；
   - **数据结构**：对 Diff 数据进行结构化处理；
   - **核心逻辑**：由提示词构成的逻辑；
   - **应用观测**：进行指标观测，如 token 消耗、API 调用 RT 等。

5. **效果调优**：
   - 提示词优化：调整数据结构，减少信息冗余；
   - 理解大模型能力边界：缺乏精确计算能力，多不等于好；
   - 工具推荐：使用 promptpilot 工具进行提示词优化；
   - 模型选择：基于效果、耗时、成本进行选择。

6. **后续规划**：
   - 用户自定义评审设置；
   - 通过 RAG 引入团队知识；
   - 建立反馈机制；
   - 结构化、半结构化、非结构化数据的应用开发。
