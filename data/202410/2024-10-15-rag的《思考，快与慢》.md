# RAG的《思考，快与慢》
- URL: https://luxiangdong.com/2024/02/07/kym/
- Added At: 2024-10-15 13:03:53
- [Link To Text](2024-10-15-rag的《思考，快与慢》_raw.md)

## TL;DR
文章探讨了RAG在未介入Agent情况下实现慢思考的方案，对比快慢思考模式，分析RAG特性及问题，提出优化索引检索和递归聚类索引（RAPTOR）等方法，强调结合Agent和LLM是未来方向，并推广TorchV Bot服务。

## Summary
1. **引言**：
   - 讨论RAG在未介入Agent情况下如何实现慢思考（全面思考）。

2. **思考模式对比**：
   - **系统1**：快思考，反应快，依赖直觉。
   - **系统2**：慢思考，需集中注意力，理性精确。
   - 举例说明两种思考模式在日常生活中的应用。

3. **RAG特性分析**：
   - RAG流程：检索、Rerank、Prompting、生成结果。
   - RAG更像系统1，反应快但结果覆盖面窄。

4. **RAG问题与Agent**：
   - RAG问题：结果覆盖面窄，难以全面思考。
   - Agent方案：串行Agent框架，但当前Agent不够成熟。
   - 对Agent的看法：需等待深度强化学习框架和国产大模型发展。

5. **RAG慢思考方案**：
   - **索引和检索环节优化**：
     - **索引**：创造数据结构（分块、元数据索引、向量化）。
     - **检索**：算法分析实现（KNN、HNSW、TF-IDF等）。

6. **递归聚类索引方案（RAPTOR）**：
   - **特点**：索引创建环节优化。
   - **流程**：
     1. **文本分割**：拆分为短chunk。
     2. **Text Embedding**：使用SBERT获得向量表示。
     3. **Clustering**：高斯混合模型和UMAP降维。
     4. **Summarization**：LLM总结每个簇。
     5. **创建节点**：聚类块+摘要=新节点。
     6. **Recursive Processing**：重复步骤2-5，形成多层树。
     7. **Retrieval**：树遍历或折叠树，计算余弦相似度。
   - **优势**：解决跨文件、非连续文档的召回问题。

7. **状态存储和控制方案**：
   - **流程**：
     1. 设定业务问题（Q1-Qn）。
     2. 使用RAG逐个检索召回。
     3. 中间状态存储在树结构中。
     4. 执行结束后输出预审报告。
   - **特点**：适用于具体业务场景，需较多设置。

8. **结论**：
   - RAG在LLM落地场景中重要，但需提升全面思考能力。
   - RAPTOR和状态存储控制方案为RAG慢思考提供思路。
   - 未来结合Agent和LLM能力是发展方向。

9. **宣传**：
   - 推广TorchV Bot，适用于企业用户的AI对话Bot服务。
