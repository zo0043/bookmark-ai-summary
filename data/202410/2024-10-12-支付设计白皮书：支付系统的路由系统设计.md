# 支付设计白皮书：支付系统的路由系统设计
- URL: https://juejin.cn/post/7121192102125387789
- Added At: 2024-10-12 07:05:45
- [Link To Text](2024-10-12-支付设计白皮书：支付系统的路由系统设计_raw.md)

## TL;DR
本文介绍了支付路由的定义、作用、分类、实现方式及设计流程，强调其在降低成本、提升用户体验等方面的价值，适用于大规模支付系统设计。作者还分享了相关经验和资源链接。

## Summary
1. **前言**：
   - 介绍了作者之前写的关于支付系统的几篇文章，并邀请读者点赞。

2. **什么是支付路由**：
   - 定义：基于支付通道属性和业务系统要求，筛选最优支付通道。
   - 举例：类比选择从广州到北京的最佳交通方式。

3. **支付路由的作用**：
   - 降低成本
   - 提高用户体验
   - 确保有可用通道
   - 特殊情况下指定特定通道

4. **路由按服务特点分类**：
   - 咨询型路由：提供通道建议
   - 服务型路由：选择并调用通道完成支付

5. **路由的实现**：
   - **筛选渠道的方式**：
     1. 人工路由：适合渠道少的情况
     2. 规则路由：常用方式，通过条件匹配渠道
     3. 基于权重的路由：复杂，需多次尝试
   - **筛选渠道的要素**：
     1. 商户侧：商户ID等信息
     2. 业务侧：交易时间、金额、渠道类型等
     3. 渠道侧：费率、营销、渠道等级等
   - **路由设计**：
     1. 业务流程：核心处理逻辑
     2. 管理页面：操作员管理入口
     3. 接口：系统模块请求入口

6. **支付路由的设计流程**：
   - **命中**：
     - 定义：交易参数触发规则引擎，找出支持交易的渠道
     - 命中维度：支付渠道、交易类型、交易机构
   - **优先级**：
     - 定义：根据渠道优先级属性进行排序
     - 注意事项：优先级不应放入规则链中
   - **可用性判断**：
     - 定义：对命中渠道进行进一步校验
     - 校验项：卡行、公私类型、限额、工作时间等
   - **成本计算**：
     - 定义：同一优先级渠道的成本计算
     - 处理方式：选择成本最低的渠道
   - **权重**：
     - 定义：同一优先级、成本相同的渠道按权重分流

7. **总结**：
   - 支付路由系统非必须，但规模较大时需设计
   - 作者自我介绍及参与活动信息

8. **附加信息**：
   - 提供了相关文章链接
   - 邀请读者参与掘金技术社区活动
