# 支付设计白皮书：支付系统的路由系统设计
- URL: https://juejin.cn/post/7121192102125387789
- Added At: 2024-10-14 17:32:29
- [Link To Text](2024-10-14-支付设计白皮书：支付系统的路由系统设计_raw.md)

## TL;DR
支付路由系统通过筛选最优支付通道，降低成本、提升用户体验。其实现包括人工、规则、权重等方式，考虑商户、业务、渠道因素。设计流程涵盖命中、优先级、可用性、成本计算和权重分配，适用于大规模支付系统。

## Summary
1. **前言**：
   - 介绍了作者之前写的关于支付系统的几篇文章，并邀请读者点赞。

2. **什么是支付路由**：
   - 定义：基于支付通道属性和业务系统要求，为支付交易筛选最优通道。
   - 举例：类比从广州到北京选择交通工具的过程。

3. **支付路由的作用**：
   - 降低成本：选择最便宜的通道。
   - 提高用户体验：确保用户支付顺畅。
   - 确保有可用通道：确保支付能完成。
   - 特殊情况指定通道：满足特定需求。

4. **路由按服务特点分类**：
   - 咨询型路由：提供通道建议。
   - 服务型路由：选择通道并完成支付。

5. **路由的实现**：
   - **筛选渠道的方式**：
     1. 人工路由：适合渠道少的情况。
     2. 规则路由：通过条件匹配选择通道。
     3. 基于权重的路由：复杂，需不断尝试权重设置。
   - **筛选渠道的要素**：
     1. 商户侧：商户ID等信息。
     2. 业务侧：交易时间、金额、渠道类型等。
     3. 渠道侧：费率、营销、渠道等级等。
   - **路由设计**：
     1. 业务流程：核心业务处理逻辑。
     2. 管理页面：系统管理入口。
     3. 接口：系统模块请求入口。

6. **支付路由设计流程**：
   - **命中**：
     - 定义：交易参数触发规则引擎，找出支持交易的渠道。
     - 命中维度：支付渠道、交易类型、交易机构。
   - **优先级**：
     - 定义：根据渠道属性进行排序。
     - 注意事项：优先级不应放入规则链中。
   - **可用性判断**：
     - 定义：对命中渠道进一步判断。
     - 判断内容：卡行支持、公私类型、限额等。
   - **成本计算**：
     - 定义：同一优先级渠道的成本计算。
     - 处理方式：选择成本最低的渠道。
   - **权重**：
     - 定义：同一成本渠道的权重分配。
     - 处理方式：按权重概率选择通道。

7. **总结**：
   - 支付路由系统是支付系统的重要模块，适用于大规模支付系统。
   - 作者自我介绍及参与活动说明。
