# 1.3 当我们聊分布式事务，我们在聊什么
- URL: https://dolphin7.xyz/2021/06/19/1.3-Talk-About-Distribute-Transaction/
- Added At: 2025-01-15 14:28:35
- [Link To Text](2025-01-15-1.3-当我们聊分布式事务，我们在聊什么_raw.md)

## TL;DR
本文探讨了分布式事务的挑战与解决方案，分析了ACID属性与CAP理论的异同，并介绍了多种分布式事务处理模式和技术。

## Summary
1. **前言问题**：
   - 事务ACID中的C一致性和分布式CAP理论中C的关系
   - 分布式环境下事务的ACID属性实现方式
   - 分布式事务方案为何会侵入业务

2. **事务ACID属性**：
   - **原子性**：确保事务要么全部完成，要么全部不做，实现方式包括undo log。
   - **隔离性**：确保事务之间不会相互干扰，实现方式包括2PL、Timestamp Ordering（T/O）等。
   - **持久性**：确保事务完成后，其结果永久保存，实现方式包括redo log。
   - **一致性**：确保事务执行后，数据库状态保持一致。

3. **CAP理论**：
   - **一致性**：所有节点在同一时间看到相同的数据。
   - **可用性**：100%可用性。
   - **分区容错性**：系统在面对分区故障时仍能正常运行。

4. **分布式事务挑战**：
   - 分布式环境下保证原子性和隔离性。
   - 2PC原子协议及其问题与改进（如3PC）。
   - Paxos协议与2PC的比较。

5. **分布式事务处理**：
   - XA规范：定义了全局事务管理器与局部资源管理器之间的接口。
   - 柔性事务：BASE理论，非ACID。

6. **分布式事务解决方案**：
   - TCC（Try-Confirm-Cancel）模式。
   - 事务消息：如RocketMQ事务消息。
   - Saga模式：基于服务统一排程，适用于长事务。
   - 可靠消息方案：保证消息的可靠传递。

7. **Seata分布式事务框架**：
   - 性能、业务侵入、隔离性等方面的讨论。

8. **CAP与ACID的取舍**：
   - 在满足一致性和可用性之间进行权衡。

9. **分布式事务总结**：
   - 分布式事务没有银弹，需要在性能、隔离性、业务侵入性等方面做取舍。

10. **FAQ**：
    - 隔离性并发控制分类。
    - 一致性模型线性一致性和顺序一致性的区别。
    - Raft协议相关问题。

11. **参考文档**：
    - 深入理解事务。
    - Pattern Saga。
    - 一致性模型笔记。
    - 分布式事务中的时间戳。
    - Multi Version Concurrency Control。
