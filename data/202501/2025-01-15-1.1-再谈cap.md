# 1.1 再谈CAP
- URL: https://dolphin7.xyz/2021/06/19/1.1-Talk-about-CAP-again/
- Added At: 2025-01-15 14:06:26
- [Link To Text](2025-01-15-1.1-再谈cap_raw.md)

## TL;DR
本文探讨了CAP定理及其局限性，提出PACELC理论，分析Redis、Zookeeper等系统在一致性、可用性和分区容错性间的取舍，强调实际应用中需根据场景选择系统属性。

## Summary
1. **CAP定理概述**：
   - **核心概念**：CAP定理指出分布式系统在一致性、可用性和分区容错性三者中只能保证两项。
   - **一致性**：所有节点访问同一份数据副本。
   - **可用性**：每次请求都能得到响应，但不保证数据最新。
   - **分区容错性**：系统在通信失败时仍能工作。

2. **CAP的误解与修正**：
   - **AP/CP伪二分法**：系统更偏向AP（如Redis）或CP（如Zookeeper），但并不意味着完全放弃其他属性。
   - **Zookeeper与Zab协议**：尽管Zookeeper实现Zab协议，在分区时仍保持一致性，但写操作在分区时不满足100%可用性。

3. **CAP定义的审视**：
   - **一致性**：线性一致性是强一致性，并非所有系统都需要。
   - **可用性**：CAP中的可用性指100%的实时响应，与实际应用的可用性不同。
   - **分区容错性**：网络分区是不可避免的。

4. **CAP定理的局限性**：
   - **狭隘范围**：仅考虑线性一致性和网络分区，未考虑时延。
   - **误导性**：CAP过于简化，实际价值有限。

5. **PACELC理论**：
   - **扩展CAP**：考虑时延因素，在网络分区时在可用性和一致性之间取舍，无分区时在时延和一致性之间取舍。

6. **Redis与分布式锁**：
   - **Redis偏向AP**：在分区时更注重可用性，可能牺牲一致性，不适合严格分布式锁。

7. **服务发现与Zookeeper**：
   - **Zookeeper偏向CP**：在分区时牺牲可用性，而服务发现场景需要高可用性，因此Eureka更合适。

8. **总结**：
   - **CAP定理的局限性**：强调一致性、可用性和分区容错性的权衡，但实际应用中更复杂。
   - **PACELC理论**：提供更全面的视角，考虑时延因素。
   - **实际应用**：根据具体场景选择系统属性，如Redis在分布式锁中的应用。
