# 文件名长度优化实施计划

## 上下文
项目中发现文件名过长问题，最长文件名达到245字符，可能导致文件系统执行失败。

## 目标
实现智能截断 + 哈希后缀的文件名优化方案，将文件名长度控制在80字符以内，同时保持可读性和唯一性。

## 选定方案
方案1：智能截断 + 哈希后缀（已完成）
- 长度限制：80字符
- 智能截断：保留前50字符 + 后20字符 + "..." + 8位哈希
- 向后兼容：提供迁移脚本

方案2：无头浏览器CAPTCHA绕过（新增）
- 核心功能：使用Playwright无头浏览器模式
- 目标：绕过基于JavaScript和浏览器指纹的CAPTCHA检测
- 优先级：作为Jina Reader失败时的备用方案
- 成本：低（无需第三方服务费用）

## 综合策略
主要使用Jina Reader + 多层回退，当遇到顽固CAPTCHA时启用无头浏览器模式作为最终手段。

## 实施步骤
1. 改进 slugify() 函数
2. 更新 get_summary_file_path() 函数
3. 更新 get_text_content_path() 函数
4. 更新关键词分析模块
5. 创建迁移脚本
6. 创建备份和恢复机制
7. 更新配置和常量
8. 测试和验证

## 配置参数
- MAX_FILENAME_LENGTH = 80
- HASH_LENGTH = 8
- TRUNCATE_PREFIX_LENGTH = 50
- TRUNCATE_SUFFIX_LENGTH = 20
- SEPARATOR = "..."

## 预期结果
- 新文件名长度控制在80字符以内
- 保持文件名可读性和关键信息
- 确保文件名唯一性
- 向后兼容现有数据结构